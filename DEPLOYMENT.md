# Render.com Deployment Guide

## âœ… Pre-Deployment Checklist

### 1. **render.yaml Configuration**
- âœ… Web service type configured
- âœ… Node.js environment specified
- âœ… Free plan selected
- âœ… Build command: `npm install`
- âœ… Start command: `npm start`
- âœ… Health check path: `/health`
- âœ… Auto-deploy enabled
- âœ… Environment variables configured
- âœ… Persistent disk storage configured

### 2. **Environment Variables**
- âœ… `NODE_ENV` set to `production`
- âœ… `JWT_SECRET` will be auto-generated by Render
- âœ… Fallback JWT_SECRET for local development

### 3. **Package.json Scripts**
- âœ… `start` script with production environment
- âœ… `dev` script for local development
- âœ… All dependencies properly listed
- âœ… Node.js engine version specified

### 4. **Server Configuration**
- âœ… Port uses `process.env.PORT || 3000`
- âœ… Health check endpoint `/health` implemented
- âœ… Graceful shutdown handlers added
- âœ… Production-specific logging
- âœ… Error handling for missing JWT_SECRET

### 5. **File Structure**
- âœ… All required files present
- âœ… Static files served from `/public`
- âœ… Uploads directory handled
- âœ… Users directory structure
- âœ… Database files managed

## ğŸš€ Deployment Steps

### 1. **Push to GitHub**
```bash
git add .
git commit -m "Enhanced Ntandostore with subdomain support and user system"
git push origin main
```

### 2. **Connect to Render.com**
1. Go to [render.com](https://render.com)
2. Connect your GitHub repository
3. Select the `render.yaml` service
4. Deploy automatically starts

### 3. **Environment Configuration**
- Render will auto-generate `JWT_SECRET`
- Verify all environment variables are set
- Check build logs for any issues

### 4. **Post-Deployment Verification**
1. **Health Check**: `https://your-app.onrender.com/health`
2. **Landing Page**: `https://your-app.onrender.com/`
3. **Dashboard**: `https://your-app.onrender.com/dashboard`
4. **User Registration**: Test account creation
5. **Site Deployment**: Test creating and editing sites

## ğŸ”§ Production Features

### **Persistent Storage**
- 1GB persistent disk attached
- User data stored in `/workspace`
- Automatic backups through disk persistence

### **Security**
- Production JWT_SECRET auto-generated
- HTTPS enforced by Render
- CORS headers properly configured
- Input validation and sanitization

### **Performance**
- Node.js production optimizations
- Static file serving through Express
- Health checks for load balancing
- Graceful shutdown handling

### **Monitoring**
- Render dashboard for metrics
- Health check endpoint monitoring
- Error logging in console
- Request/response logging

## ğŸ› Troubleshooting

### **Common Issues**

#### **Build Failures**
```bash
# Check package.json dependencies
npm install --production
# Verify Node.js version compatibility
node --version
```

#### **Runtime Errors**
```bash
# Check logs in Render dashboard
# Verify JWT_SECRET is set
# Check file permissions
```

#### **Site Access Issues**
```bash
# Verify directory structure
# Check static file serving
# Test health endpoint
```

### **Health Check Response**
```json
{
  "status": "OK",
  "service": "Ntandostore Enhanced Free Hosting",
  "features": ["Subdomains", "User System", "Site Editing", "Templates", "Backups"],
  "timestamp": "2024-01-01T00:00:00.000Z"
}
```

## ğŸ“Š Performance Monitoring

### **Render Metrics**
- Response times
- Error rates
- Memory usage
- CPU utilization

### **Application Metrics**
- User registrations
- Site deployments
- Visit analytics
- Storage usage

## ğŸ”„ Updates and Maintenance

### **Automatic Deployments**
- Push to main branch triggers deployment
- Zero-downtime deployments
- Rollback capability in Render dashboard

### **Manual Deployments**
- Manual trigger available in Render
- Branch-specific deployments
- Environment variable updates

## ğŸ“± Post-Deployment Testing

1. **User Registration Flow**
   - Create new account
   - Verify email requirements
   - Test login functionality

2. **Site Creation Flow**
   - Upload new site
   - Test template selection
   - Verify subdomain assignment

3. **Site Editing Flow**
   - Edit existing site
   - Test backup creation
   - Verify site updates

4. **URL Routing**
   - Test subdomain access
   - Verify direct URL access
   - Check backward compatibility

The enhanced Ntandostore platform is fully optimized for Render.com deployment with all production-ready features implemented!